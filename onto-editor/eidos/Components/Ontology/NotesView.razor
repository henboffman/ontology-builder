<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <div>
            <h5 class="mb-0">
                <i class="bi bi-journal-text"></i> Ontology Notes
                <button class="btn btn-sm btn-link" title="Markdown help" @onclick="() => showMarkdownHelp = !showMarkdownHelp">
                    <i class="bi bi-question-circle"></i>
                </button>
            </h5>
            <small class="text-muted">Markdown-formatted documentation and notes</small>
        </div>
        <button class="btn btn-primary btn-sm" @onclick="OnSaveClick" title="Save your notes to the database"
                disabled="@(!CanEdit)">
            <i class="bi bi-save"></i> Save Notes
        </button>
    </div>
    <div class="card-body">
        @if (showMarkdownHelp)
        {
            <div class="alert alert-info small mb-3">
                <h6 class="alert-heading"><i class="bi bi-lightbulb"></i> Markdown Quick Reference</h6>
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-1"><strong>Headers:</strong></p>
                        <code># Heading 1</code><br />
                        <code>## Heading 2</code><br />
                        <code>### Heading 3</code>
                        <p class="mb-1 mt-2"><strong>Formatting:</strong></p>
                        <code>**bold text**</code><br />
                        <code>*italic text*</code><br />
                        <code>`code`</code>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-1"><strong>Lists:</strong></p>
                        <code>- Bullet point</code><br />
                        <code>1. Numbered item</code>
                        <p class="mb-1 mt-2"><strong>Links:</strong></p>
                        <code>[text](https://url)</code>
                        <p class="mb-1 mt-2"><strong>Code blocks:</strong></p>
                        <code>```language</code><br />
                        <code>code here</code><br />
                        <code>```</code>
                    </div>
                </div>
            </div>
        }
        <textarea class="form-control" rows="20" @bind="notes"
                  placeholder="# Ontology Notes&#10;&#10;Add your notes here using Markdown format...&#10;&#10;## Example&#10;- Bullet point 1&#10;- Bullet point 2"
                  style="font-family: monospace;"
                  readonly="@(!CanEdit)"></textarea>
    </div>
    <div class="card-footer bg-light">
        <div class="alert alert-info mb-0 py-2">
            <i class="bi bi-info-circle"></i>
            <strong>Tip:</strong> You can use Markdown formatting in your notes. This is a great place to document design decisions, requirements, or usage guidelines for your ontology.
        </div>
    </div>
</div>

@code {
    [Parameter]
    public string Notes { get; set; } = string.Empty;

    [Parameter]
    public EventCallback<string> NotesChanged { get; set; }

    [Parameter]
    public EventCallback OnSaveClick { get; set; }

    [Parameter]
    public bool CanEdit { get; set; } = true;

    private bool showMarkdownHelp = false;

    private string notes
    {
        get => Notes;
        set
        {
            if (Notes != value)
            {
                Notes = value;
                NotesChanged.InvokeAsync(value);
            }
        }
    }
}
