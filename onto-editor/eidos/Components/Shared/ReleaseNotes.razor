@inject ILogger<ReleaseNotes> Logger

<div class="release-notes-container">
    <div class="release-notes-header">
        <h3>
            <i class="bi bi-megaphone me-2"></i>
            Release Notes
        </h3>
    </div>

    <div class="release-timeline">
        <!-- Latest: Individual Visualization in Graph View -->
        <div class="release-item">
            <div class="release-badge badge bg-primary">Latest</div>
            <div class="release-date">October 29, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-diagram-3 text-primary me-2"></i>
                Individual Visualization in Graph View
            </h4>
            <div class="release-content">
                <p class="lead">Visualize the complete picture - see both your ontology structure AND individual instances in the graph view!</p>

                <h5>Graph Visualization Enhancements</h5>
                <ul class="feature-list">
                    <li>
                        <strong>"Show Individuals" Toggle</strong>
                        <ul>
                            <li>New checkbox in graph toolbar to show/hide individual instances</li>
                            <li>Only appears when your ontology contains individuals</li>
                            <li>Seamlessly switch between structure-only and full instance view</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Individual Node Styling</strong>
                        <ul>
                            <li>Diamond-shaped nodes distinguish individuals from concepts</li>
                            <li>Dashed borders for clear visual separation</li>
                            <li>Transparent colors (40% opacity) derived from parent concept</li>
                            <li>Fully compatible with dark/light themes</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Instance Relationships</strong>
                        <ul>
                            <li>Dotted "instance of" lines connect individuals to their concepts</li>
                            <li>Purple solid lines show relationships between individuals</li>
                            <li>All edges fully interactive with hover tooltips</li>
                        </ul>
                    </li>
                </ul>

                <h5>Technical Implementation</h5>
                <ul class="feature-list">
                    <li>Enhanced OntologyRepository to load Individuals and IndividualRelationships</li>
                    <li>Cytoscape.js diamond node shape with custom styling</li>
                    <li>RGBA color format for proper transparency rendering</li>
                    <li>Blazor parameter binding with StateHasChanged() for responsive updates</li>
                </ul>

                <div class="alert alert-info mt-3">
                    <i class="bi bi-lightbulb me-2"></i>
                    <strong>Example:</strong> If you have a "Server" concept with instances like "Dev", "Test", and "Prod", toggle "Show Individuals" to see all three servers as diamond nodes connected to the Server concept!
                </div>
            </div>
        </div>

        <!-- Real-Time Presence Tracking -->
        <div class="release-item">
            <div class="release-date">October 28, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-people-fill text-success me-2"></i>
                Real-Time Presence Tracking
            </h4>
            <div class="release-content">
                <p class="lead">Google Docs / Figma-style collaboration awareness - see who's viewing your ontology in real-time!</p>

                <h5>Presence Indicators</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Live User Avatars</strong>
                        <ul>
                            <li>Color-coded avatars with user initials</li>
                            <li>Shows up to 5 users with "+N" indicator for additional viewers</li>
                            <li>Hover to see user names and current view</li>
                            <li>"Just you" message when working alone</li>
                            <li>Smooth fade-in animations when users join/leave</li>
                        </ul>
                    </li>
                    <li>
                        <strong>View Tracking</strong>
                        <ul>
                            <li>See which tab each user is viewing (Graph, List, Hierarchy, etc.)</li>
                            <li>View-specific icons on user avatars</li>
                            <li>View labels under avatars</li>
                            <li>Real-time updates when users switch tabs</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Colored Tab Indicators</strong>
                        <ul>
                            <li>User-colored dots on tab buttons show who's viewing each tab</li>
                            <li>Shows up to 3 colored dots per tab with "+N" for additional viewers</li>
                            <li>Enhanced tooltips listing all viewer names</li>
                            <li>Visual consistency between avatars and tab indicators</li>
                        </ul>
                    </li>
                </ul>

                <h5>Multi-Provider Authentication Support</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Smart Display Name Resolution</strong>
                        <ul>
                            <li>Compatible with Entra ID (Azure AD)</li>
                            <li>Supports Google, GitHub, Microsoft OAuth</li>
                            <li>Priority fallback chain for reliable name display</li>
                            <li>Graceful handling of missing name claims</li>
                        </ul>
                    </li>
                </ul>

                <h5>Technical Implementation</h5>
                <ul class="feature-list">
                    <li>SignalR hub with permission-based access control</li>
                    <li>30-second heartbeat for presence maintenance</li>
                    <li>Automatic cleanup on disconnect</li>
                    <li>Thread-safe concurrent data structures</li>
                    <li>Hash-based consistent color assignment</li>
                    <li>Dark mode support throughout</li>
                </ul>

                <h5>Security</h5>
                <ul class="feature-list">
                    <li>Authentication required - no anonymous presence</li>
                    <li>Permission validation via share system</li>
                    <li>Owner and invited users both supported</li>
                    <li>PII protection - emails only to authorized users</li>
                    <li>Comprehensive audit logging</li>
                    <li>Input validation on all user data</li>
                </ul>

                <div class="alert alert-success mt-3">
                    <i class="bi bi-eye me-2"></i>
                    <strong>Try it now:</strong> Open an ontology in two different browser windows or share with a colleague to see real-time presence in action!
                </div>
            </div>
        </div>

        <!-- Branding & UX Updates -->
        <div class="release-item">
            <div class="release-date">October 28, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-palette text-info me-2"></i>
                Branding & User Experience Updates
            </h4>
            <div class="release-content">
                <p class="lead">New visual identity and improved user experience for power users.</p>

                <h5>Visual Branding</h5>
                <ul class="feature-list">
                    <li>
                        <strong>New Eidos Logo</strong>
                        <ul>
                            <li>Modern logo with colorful striped "e" design</li>
                            <li>Updated brand in top navigation bar</li>
                            <li>New favicon for browser tabs and bookmarks</li>
                            <li>Enhanced login page with prominent branding</li>
                        </ul>
                    </li>
                </ul>

                <h5>Power User Features</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Bulk Concept Entry</strong>
                        <ul>
                            <li>"Save & Add Another" button for rapid concept creation</li>
                            <li>Keyboard shortcut: Ctrl+Enter to save and continue</li>
                            <li>Smart field persistence (keeps category between entries)</li>
                            <li>Auto-focus on name field for seamless workflow</li>
                        </ul>
                    </li>
                    <li>
                        <strong>GitHub-Style Settings Page</strong>
                        <ul>
                            <li>Standalone settings page with dedicated URL</li>
                            <li>Tab navigation: General, Permissions, Sharing, Danger Zone</li>
                            <li>Mobile-responsive sidebar navigation</li>
                            <li>More organized and spacious interface</li>
                        </ul>
                    </li>
                </ul>

                <div class="alert alert-success mt-3">
                    <i class="bi bi-lightbulb me-2"></i>
                    <strong>Tip:</strong> Use Ctrl+Enter when adding concepts to quickly build out your ontology without
                    repetitive clicking!
                </div>
            </div>
        </div>

        <!-- Performance Optimizations & Dashboard Fix -->
        <div class="release-item">
            <div class="release-date">October 28, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-speedometer2 text-warning me-2"></i>
                Performance Optimizations & Dashboard Fix
            </h4>
            <div class="release-content">
                <p class="lead">Major performance improvements and dashboard count accuracy.</p>

                <h5>Dashboard Improvements</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Fixed Dashboard Count Display</strong>
                        <ul>
                            <li>Dashboard now correctly shows concept and relationship counts</li>
                            <li>Implemented denormalized count tracking for O(1) access</li>
                            <li>Counts automatically maintained on create/delete operations</li>
                            <li>No longer shows "0 concepts 0 relationships" for populated ontologies</li>
                        </ul>
                    </li>
                </ul>

                <h5>Performance Enhancements</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Query Optimization</strong>
                        <ul>
                            <li>Fixed N+1 query in GetCollaboratorsAsync (reduced from 20+ queries to 3)</li>
                            <li>Optimized GetParentConceptsAsync/GetChildConceptsAsync (60-80% latency reduction)</li>
                            <li>Batch query optimization for CloneOntologyAsync (from 5-10s to under 1s)</li>
                            <li>Recursive CTE for GetOntologyDescendantsAsync (eliminates full table scan)</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Permission Service Optimization</strong>
                        <ul>
                            <li>Uses projection instead of full entity loads (reduced memory footprint)</li>
                            <li>Changed BaseRepository operations to use AsNoTracking()</li>
                            <li>Optimized ExistsAsync to use AnyAsync() instead of FindAsync()</li>
                        </ul>
                    </li>
                    <li>
                        <strong>User Preferences Caching</strong>
                        <ul>
                            <li>In-memory cache with 5-minute sliding expiration</li>
                            <li>Significant reduction in database queries for frequently accessed preferences</li>
                            <li>Automatic cache invalidation on updates</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Database Optimization</strong>
                        <ul>
                            <li>Added 7 performance indexes on foreign key columns</li>
                            <li>Improved query execution times across the application</li>
                        </ul>
                    </li>
                </ul>

                <h5>Performance Impact</h5>
                <ul class="feature-list">
                    <li>API latency reduced by 60-80% for affected operations</li>
                    <li>Memory usage reduced by 70-90% for read operations</li>
                    <li>Faster page loads and data retrieval</li>
                    <li>More responsive user interface</li>
                </ul>

                <div class="alert alert-success mt-3">
                    <i class="bi bi-speedometer2 me-2"></i>
                    <strong>Result:</strong> Dashboard loads significantly faster and displays accurate counts for all
                    ontologies.
                </div>
            </div>
        </div>

        <!-- Group Management & Permissions -->
        <div class="release-item">
            <div class="release-date">October 26, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-shield-lock text-success me-2"></i>
                Group Management & Permission System
            </h4>
            <div class="release-content">
                <p class="lead">Fine-grained access control with group-based permissions for ontologies.</p>

                <h5>New Features</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Ontology Permission System</strong>
                        <ul>
                            <li>Three visibility levels: Private, Group, and Public</li>
                            <li>Three permission levels: View, Edit, and Admin</li>
                            <li>Permission hierarchy with inheritance</li>
                            <li>Public edit toggle for open collaboration</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Group Management UI</strong>
                        <ul>
                            <li>New Permissions tab in Ontology Settings dialog</li>
                            <li>Add/remove group access with permission levels</li>
                            <li>Change permission levels for existing groups</li>
                            <li>View member counts and grant history</li>
                            <li>Real-time permission updates</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Role-Based Access Control (RBAC)</strong>
                        <ul>
                            <li>Four user roles: Admin, PowerUser, User, Guest</li>
                            <li>Permission checks at UI and service layers</li>
                            <li>Home page filters by accessible ontologies</li>
                            <li>Ontology view validates edit permissions</li>
                        </ul>
                    </li>
                    <li>
                        <strong>OAuth Improvements</strong>
                        <ul>
                            <li>Conditional OAuth button rendering (only shows configured providers)</li>
                            <li>Comprehensive error handling in OAuth event handlers</li>
                            <li>Prevents login failures from breaking authentication flow</li>
                            <li>Configuration detection for Google, Microsoft, and GitHub</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Dark Mode Enhancements</strong>
                        <ul>
                            <li>Fixed Learn page contrast issues</li>
                            <li>Proper badge text colors in dark mode</li>
                            <li>Readable navigation and content sections</li>
                        </ul>
                    </li>
                </ul>

                <h5>Testing</h5>
                <ul class="feature-list">
                    <li>32 new comprehensive tests added (157+ total tests)</li>
                    <li>OntologyPermissionService integration tests (20+ tests)</li>
                    <li>LoginModel OAuth configuration unit tests (12 tests)</li>
                    <li>100% pass rate maintained</li>
                </ul>

                <div class="alert alert-info mt-3">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>How to use:</strong> Open any ontology settings to manage group permissions and visibility.
                    Navigate to Home to see only ontologies you have access to.
                </div>
            </div>
        </div>

        <!-- Version Control & Activity Tracking -->
        <div class="release-item">
            <div class="release-date">October 26, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-clock-history text-primary me-2"></i>
                Version Control & Activity Tracking
            </h4>
            <div class="release-content">
                <p class="lead">Track every change made to your ontologies with complete version history.</p>

                <h5>New Features</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Version History Panel</strong>
                        <ul>
                            <li>Timeline view of all changes</li>
                            <li>Filter by entity type (concepts, relationships, properties)</li>
                            <li>Filter by activity type (create, update, delete)</li>
                            <li>Statistics dashboard showing contributors and activity breakdown</li>
                            <li>Before/after snapshots for all changes</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Automatic Activity Recording</strong>
                        <ul>
                            <li>Tracks all concept and relationship changes</li>
                            <li>Captures complete before/after state</li>
                            <li>Auto-incrementing version numbers</li>
                            <li>User attribution for all changes</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Version Comparison</strong>
                        <ul>
                            <li>Side-by-side diff view</li>
                            <li>Highlights added, modified, and removed fields</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Revert Capability</strong> (foundation - full implementation coming soon)
                    </li>
                </ul>

                <div class="alert alert-info mt-3">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>How to use:</strong> Click the "History" button in any ontology to view the complete version
                    timeline.
                </div>
            </div>
        </div>

        <!-- Collaborator Tracking -->
        <div class="release-item">
            <div class="release-date">October 26, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-people text-success me-2"></i>
                Collaborator Tracking System
            </h4>
            <div class="release-content">
                <p class="lead">See who's working on your ontologies and track their contributions.</p>

                <h5>New Features</h5>
                <ul class="feature-list">
                    <li>
                        <strong>Collaborator Panel</strong>
                        <ul>
                            <li>View all users and guests with access</li>
                            <li>Permission level badges (View, Can Edit, Full Access)</li>
                            <li>Access statistics (first accessed, last active)</li>
                            <li>Guest user identification</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Edit Statistics</strong>
                        <ul>
                            <li>Per-user contribution breakdown</li>
                            <li>Counts for concepts, relationships, and properties</li>
                            <li>Created, updated, and deleted tracking</li>
                        </ul>
                    </li>
                    <li>
                        <strong>Activity Timeline</strong>
                        <ul>
                            <li>Recent activity for each collaborator</li>
                            <li>Chronological list with descriptions</li>
                            <li>Entity names and timestamps</li>
                        </ul>
                    </li>
                </ul>

                <div class="alert alert-info mt-3">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>How to use:</strong> Click the "Collaborators" button to see everyone working on your
                    ontology.
                </div>
            </div>
        </div>

        <!-- Testing Infrastructure -->
        <div class="release-item">
            <div class="release-date">October 25, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-shield-check text-info me-2"></i>
                Enhanced Testing Infrastructure
            </h4>
            <div class="release-content">
                <p>Comprehensive test suite ensuring reliability and quality.</p>
                <ul class="feature-list">
                    <li>125+ automated tests (100% passing) - expanded to 157+ with permission system tests</li>
                    <li>Component tests with bUnit</li>
                    <li>Service integration tests</li>
                    <li>Repository tests with in-memory database</li>
                    <li>End-to-end workflow tests</li>
                </ul>
            </div>
        </div>

        <!-- Dark Mode -->
        <div class="release-item">
            <div class="release-date">October 25, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-moon-stars text-warning me-2"></i>
                Dark Mode & Theme Support
            </h4>
            <div class="release-content">
                <p>Easy on the eyes, day or night.</p>
                <ul class="feature-list">
                    <li>Light and dark mode themes</li>
                    <li>Persisted user preference</li>
                    <li>Smooth theme transitions</li>
                    <li>Color-blind friendly palette</li>
                    <li>System theme detection</li>
                </ul>
            </div>
        </div>

        <!-- Mobile Responsive -->
        <div class="release-item">
            <div class="release-date">October 24, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-phone text-danger me-2"></i>
                Mobile Responsive Design
            </h4>
            <div class="release-content">
                <p>Work on your ontologies anywhere, on any device.</p>
                <ul class="feature-list">
                    <li>Touch-friendly graph editor</li>
                    <li>Mobile-optimized controls</li>
                    <li>Responsive layouts for all views</li>
                    <li>Collapsible sidebars on small screens</li>
                    <li>Gesture support (pinch-zoom, pan)</li>
                </ul>
            </div>
        </div>

        <!-- Production Deployment -->
        <div class="release-item">
            <div class="release-date">October 24, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-cloud-upload text-primary me-2"></i>
                Production Deployment
            </h4>
            <div class="release-content">
                <p>Deployed with enterprise-grade infrastructure and security.</p>
                <ul class="feature-list">
                    <li>Secure cloud hosting</li>
                    <li>Managed database with automatic backups</li>
                    <li>Encrypted secrets management</li>
                    <li>Application performance monitoring</li>
                    <li>HTTPS-only with TLS 1.2+</li>
                    <li>Continuous deployment with GitHub Actions</li>
                    <li>Custom domain: https://eidosonto.com</li>
                </ul>
            </div>
        </div>

        <!-- Initial Release -->
        <div class="release-item">
            <div class="release-date">October 20, 2025</div>
            <h4 class="release-title">
                <i class="bi bi-rocket text-success me-2"></i>
                Initial Release
            </h4>
            <div class="release-content">
                <p>The foundation of Eidos Ontology Builder.</p>
                <h5>Core Features</h5>
                <ul class="feature-list">
                    <li>Ontology management (create, edit, delete)</li>
                    <li>Concept and relationship management</li>
                    <li>Interactive graph visualization</li>
                    <li>List and hierarchy views</li>
                    <li>TTL export/import</li>
                    <li>Template system</li>
                    <li>Fork/clone ontologies</li>
                    <li>Undo/redo support</li>
                    <li>Real-time collaboration</li>
                    <li>User authentication (OAuth)</li>
                    <li>User preferences</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="release-footer">
        <div class="alert alert-secondary">
            <h5><i class="bi bi-info-circle me-2"></i>About Eidos</h5>
            <p class="mb-2">
                <strong>Eidos Ontology Builder</strong> is a modern web application for creating, managing, and
                visualizing ontologies.
                Built with Blazor Server and .NET 9, it provides an intuitive interface for knowledge organization and
                semantic modeling.
            </p>
            <div class="row mt-3">
                <div class="col-md-6">
                    <h6>Technology Stack</h6>
                    <ul class="list-unstyled small">
                        <li><i class="bi bi-check2 text-success"></i> Blazor Server (.NET 9)</li>
                        <li><i class="bi bi-check2 text-success"></i> SQL Database</li>
                        <li><i class="bi bi-check2 text-success"></i> SignalR (Real-time)</li>
                        <li><i class="bi bi-check2 text-success"></i> Cytoscape.js (Visualization)</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h6>Links</h6>
                    <ul class="list-unstyled small">
                        <li><i class="bi bi-globe"></i> <a href="https://eidosonto.com"
                                target="_blank">eidosonto.com</a></li>
                        <li><i class="bi bi-github"></i> <a href="#" target="_blank">GitHub Repository</a></li>
                        <li><i class="bi bi-book"></i> <a href="#" target="_blank">Documentation</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@code
{
    protected override void OnInitialized()
    {
        Logger.LogInformation("Release Notes page loaded");
    }
}